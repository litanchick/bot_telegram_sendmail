
# bot_telegram_for_send_mail
## Описание проекта.
Бот работает через библиотеки telegram и telegram.ext написан на Python использует базу данных SQLite3 сейчас, но при формировании контейнера Docker для размещения на сервере буду подключить базу PostgreSQL.

Проверяет есть ли входящие новые сообщения в чатах, если есть, достаёт логин, текст, id сообщения и название и id чата. Кладет в БД, отправляет с этой информацией и инструкцией письмо (если один и тот же пользователь написал сообщения с разницей менее 5-ти минут - сообщение на почту не отправляется, при этом в БД сохраняется с пометкой "dont need send") на почту через сервис SMTP. Все переменные хранятся в окружении (dotenv). Есть отдельный файл с константами для хранения инструкций и времени работы чатов.

Нет пользовательского интерфейса для изменения настроек, но возможно со временем появится. Либо через командное меню Ботика, либо через Django админку, например. Во втором случае с БД работать будет проще.

## Запуск бота.
### Перед запуском проекта необходимо развернуть виртуальное окружение, например Venv:
1. Откройте терминал в нужной директории.
2. Введите команду:
    - `python -m venv venv` - для Windows.
    - `python3 -m venv venv` - для Mac и Linux.

_Второе 'venv' можно замнить на любое другое имя директории, для удобства лучше, если будет называться именем проекта._

3. Активируйте виртуальное окружение:
    - `source venv/Scripts/activate` - для Windows.
    - `source venv/bin/activate` - для Mac и Linux.

_Имя директории после 'source' - это название вашей директории с виртуальным окружением._

### Установите менеджер пакетов pip:
- `python -m pip install --upgrade pip` - для Windows.
- `python3 -m pip install --upgrade pip` - Mac и Linux.

### Установите все зависимости из файла requirments.txt:
- `pip install -r requirements.txt` - для Windows, Mac и Linux.

### Переменные файла данных constans.py.
 <span style="color: #DC143C">EMAIL</span> - почта отправителя.  

<span style="color: #DC143C">END_EMAIL</span> - почта получателя.  
Прописать в файле constans.py, где <span style="color: #7B68EE">PASSWORD</span> - это пароль приложений, а <span style="color: #7B68EE">USERNAME</span> - логин до '@'.  
```
PASSWORD = '********'
USERNAME = '********'
```
<span style="color: #DC143C">LIST_EXIST_USERNAME</span> - список с логинами, формат <span style="color: #7B68EE">
str</span>.  

<span style="color: #DC143C">
TEXT_MESSAGE</span> - словарь, где ключи - это язык сообщения (в РФ разделение по тематикам: товары, такси) в словаре <span style="color: #7B68EE">
TIME_WORK_CHAT</span> для каждой страны свои данные. Значения по ключам - это текст сообщения отбивки, в которую передаются переменные в фигурных скобках <span style="color: #7B68EE">
{}</span>, через метод <span style="color: #7B68EE">
.format</span> строки.  

<span style="color: #DC143C">TIME_WORK_CHAT</span> - словарь с ключами обозначение страны, например <span style="color: #7B68EE">
"RU"</span>, значением которого является тоже словарь с ключами: <span style="color: #7B68EE">
'time_begin'</span> - время начала работы чата, <span style="color: #7B68EE">
'time_close'</span> - время окончания работы чата, <span style="color: #7B68EE">
'language_message'</span> - язык обивки сообщения (значение - список), <span style="color: #7B68EE">
'timezone_delta'</span> - часовой пояс относительно МСК (значение - список, например, для летнего и зимнего времени).  

<span style="color: #DC143C">INSTR</span> - инструкция отправляемая в письме к сообщению чата с двумя ключами: для РФ чатов и для интернациональных чатов.

### Последовательность запуска файлов.
Запускаем сначала файл <span style="color: #7B68EE">settings.py</span>, таким образом у нас создается БД. - Потом запускаем файл <span style="color: #7B68EE">bot_2.0.py</span>.


### Разрешения в учетной записи отправителя для отправки писем.
- Разрешить в почте отправителя: доступ к почтовому ящику с помощью почтовых клиентов: с сервера imap.yandex.ru по протоколу IMAP, способ авторизации по IMAP, пароли приложений и OAuth-токены.
- Создать пароль приложений.

---

## Информация об авторах.
Написан: [litanchick](https://github.com/litanchick).